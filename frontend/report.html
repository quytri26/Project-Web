<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Báo cáo - Quản lý lương</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <h2 class="mb-4">Báo Cáo Lương</h2>

      <!-- Bộ lọc tháng -->
      <div class="d-flex align-items-center mb-3">
        <label class="me-2 fw-bold">Chọn tháng:</label>
        <input type="month" class="form-control w-auto" value="2025-09" />
      </div>

      <!-- Bảng báo cáo -->
      <table class="table table-striped table-bordered shadow-sm">
        <thead class="table-dark">
          <tr>
            <th>#</th>
            <th>Nhân viên</th>
            <th>Số điện thoại</th>
            <th>Tháng</th>
            <th>Lương</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>Nguyễn Văn A</td>
            <td>0901234567</td>
            <td>09/2025</td>
            <td>12,000,000 ₫</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Trần Thị B</td>
            <td>0987654321</td>
            <td>09/2025</td>
            <td>11,500,000 ₫</td>
          </tr>
        </tbody>
      </table>

      <!-- Nút xuất -->
      <div class="mt-3">
        <button class="btn btn-success me-2">
          <i class="bi bi-file-earmark-excel"></i> Xuất Excel
        </button>
        <button class="btn btn-danger">
          <i class="bi bi-file-earmark-pdf"></i> Xuất PDF
        </button>
      </div>
    </div>
  </body>
</html>


<!-- thêm kết nối -->

<script>
const monthInput = document.querySelector("input[type='month']");
const tableBody = document.querySelector("tbody");

async function loadReport() {
  const [year, month] = monthInput.value.split("-");
  const res = await fetch(`http://localhost:3000/api/bangluong/baocao/${year}/${month}`);
  const data = await res.json();
  tableBody.innerHTML = data
    .map(
      (r, i) => `
      <tr>
        <td>${i + 1}</td>
        <td>${r.ho_ten}</td>
        <td>-</td>
        <td>${month}/${year}</td>
        <td>${r.tong_luong.toLocaleString("vi-VN")} ₫</td>
      </tr>`
    )
    .join("");
}

monthInput.addEventListener("change", loadReport);
loadReport();
</script>
